title: 小程序 相册授权再次询问
date: 2018/10/30
categories:

- 前端
- 小程序
tags:
- 相册授权
comments: true
---

#### 相册授权
小程序中将图片或者视频，下载后保存到用户本地相册需要用户授权。若用户首次拒绝授权，再次下载时，得再次弹出询问授权按钮，否则图片无法下载。
1. 保存到相册，首次拒绝授权，第二次保存失败，再次询问 wx.openSetting
```js
wx.saveVideoToPhotosAlbum({
    filePath: res.tempFilePath,
    success: res => {
        this.showMsg('视频已保存到相册~~');
    },
    fail: res => {
        this.getPhotoAuthorize();
    }
});

getPhotoAuthorize: function () {
    wx.showModal({
        title: '提示',
        confirmText: '去授权',
        content: '授权后才能保存到相册噢',
        success: res => {
            if (res.confirm) {
                console.log('用户点击授权')
                wx.openSetting({
                    success: function (res) {
                        if (!res.authSetting["scope.writePhotosAlbum"]) {
                            console.log('重新授权成功')
                        }
                    }
                })
            }
        }
    })
}
```

欢迎大家给我留言，提建议，指出错误，一起讨论学习技术的感受！